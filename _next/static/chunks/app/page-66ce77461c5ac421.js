(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2887:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>ec});var i=s(5155),n=s(2115),a=s(8492),t=s(2531),d=s(317),r=s(6245),c=s(357),h=s(9300),o=s(5416),x=s(670),A=s(7154),j=s(4177),u=s(9919),f=s(8963),m=s(7855),v=s(8447),g=s(5970),p=s(6120),S=s(223),C=s(4463),b=s(1512),y=s(6388),w=s(4288),E=s(1665),I=s(6170),G=s(2078),k=s(9708);let R=(0,G.Wp)({apiKey:"AIzaSyAffBMfX9NHVgSg_w4a8ZKa55vmp0eHb2w",authDomain:"dd5tools.firebaseapp.com",databaseURL:"https://dd5tools.firebaseio.com",projectId:"dd5tools",storageBucket:"dd5tools.appspot.com",messagingSenderId:"1096592466642",appId:"1:1096592466642:web:f03ea81d304964f1f1030b"}),W=(0,k.aU)(R),N="default_other",U={CATEGORIES:"categories",EFFECTS:"effects",RELICS:"relics",NIGHTRUNNERS:"nightrunners",GRAILS:"grails"},z={getAll:async()=>{let e=(0,k.rJ)(W,U.CATEGORIES),l=(0,k.P)(e,(0,k.My)("name")),s=(await (0,k.GG)(l)).docs.map(e=>({...e.data(),id:e.id}));if(!s.find(e=>e.id===N)){let e={id:N,name:"その他"};await (0,k.BN)((0,k.H9)(W,U.CATEGORIES,N),{name:e.name}),s.unshift(e)}return s},save:async e=>{let l=(0,k.wP)(W);(await (0,k.GG)((0,k.rJ)(W,U.CATEGORIES))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,k.H9)(W,U.CATEGORIES,e.id);l.set(s,{name:e.name})}),await l.commit()}},F={getAll:async()=>{let e=(0,k.rJ)(W,U.EFFECTS),l=(await (0,k.GG)(e)).docs.map(e=>({...e.data(),id:e.id}));if(l.some(e=>!e.categoryId)){let e=(0,k.wP)(W);l.forEach(l=>{if(!l.categoryId){l.categoryId=N;let s=(0,k.H9)(W,U.EFFECTS,l.id);e.update(s,{categoryId:N})}}),await e.commit()}return l},save:async e=>{let l=(0,k.wP)(W);(await (0,k.GG)((0,k.rJ)(W,U.EFFECTS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,k.H9)(W,U.EFFECTS,e.id);l.set(s,{categoryId:e.categoryId,description:e.description})}),await l.commit()}},T={getAll:async()=>{let e=(0,k.rJ)(W,U.RELICS);return(await (0,k.GG)(e)).docs.map(e=>({...e.data(),id:e.id}))},save:async e=>{let l=(0,k.wP)(W);(await (0,k.GG)((0,k.rJ)(W,U.RELICS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,k.H9)(W,U.RELICS,e.id);l.set(s,{color:e.color,effects:e.effects})}),await l.commit()}},H={getAll:async()=>{let e=(0,k.rJ)(W,U.NIGHTRUNNERS);return(await (0,k.GG)(e)).docs.map(e=>({...e.data(),id:e.id}))},save:async e=>{let l=(0,k.wP)(W);(await (0,k.GG)((0,k.rJ)(W,U.NIGHTRUNNERS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,k.H9)(W,U.NIGHTRUNNERS,e.id);l.set(s,{name:e.name})}),await l.commit()}},P={getAll:async()=>{let e=(0,k.rJ)(W,U.GRAILS);return(await (0,k.GG)(e)).docs.map(e=>({...e.data(),id:e.id}))},save:async e=>{let l=(0,k.wP)(W);(await (0,k.GG)((0,k.rJ)(W,U.GRAILS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,k.H9)(W,U.GRAILS,e.id);l.set(s,{nightRunnerId:e.nightRunnerId,colors:e.colors})}),await l.commit()}};var D=s(5265),J=s(2021),L=s(9496),O=s(6370);function _(e){let{open:l,effect:s,categories:a,onSave:t,onClose:d}=e,[r,h]=(0,n.useState)(""),[o,v]=(0,n.useState)(N);return(0,n.useEffect)(()=>{s?(h(s.description),v(s.categoryId||N)):(h(""),v(N))},[s]),(0,i.jsxs)(D.A,{open:l,onClose:d,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"効果を編集":"効果を登録"}),(0,i.jsx)(L.A,{children:(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:o,label:"カテゴリ",onChange:e=>v(e.target.value),children:a.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsx)(x.A,{autoFocus:!0,label:"効果",fullWidth:!0,value:r,onChange:e=>h(e.target.value)})]})}),(0,i.jsxs)(O.A,{children:[(0,i.jsx)(m.A,{onClick:d,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{t({id:(null==s?void 0:s.id)||crypto.randomUUID(),categoryId:o,description:r}),h(""),v(N)},variant:"contained",disabled:!r,children:"保存"})]})]})}function M(){let[e,l]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[t,d]=(0,n.useState)(""),[r,h]=(0,n.useState)(""),[o,G]=(0,n.useState)(null),[k,R]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let[e,s]=await Promise.all([F.getAll(),z.getAll()]);l(e),a(s)})()},[]);let W=async s=>{let i;l(i=o?e.map(e=>e.id===s.id?s:e):[...e,s]),await F.save(i),R(!1),G(null)},N=async s=>{let i=e.filter(e=>e.id!==s);l(i),await F.save(i)},U=e.filter(e=>{let l=e.description.includes(t),s=!r||e.categoryId===r;return l&&s});return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(c.A,{sx:{mb:2,display:"flex",gap:2},children:[(0,i.jsx)(x.A,{label:"効果で検索",value:t,onChange:e=>d(e.target.value),fullWidth:!0}),(0,i.jsxs)(A.A,{sx:{minWidth:200},children:[(0,i.jsx)(j.A,{children:"カテゴリで絞込"}),(0,i.jsxs)(u.A,{value:r,label:"カテゴリで絞込",onChange:e=>h(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),s.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))]})]}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{G(null),R(!0)},children:"新規登録"})]}),(0,i.jsx)(v.A,{component:g.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{width:150,children:"カテゴリ"}),(0,i.jsx)(b.A,{children:"効果"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:U.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.name)||"その他"})(e.categoryId)}),(0,i.jsx)(b.A,{children:e.description}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{G(e),R(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>N(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(_,{open:k,effect:o,categories:s,onSave:W,onClose:()=>{R(!1),G(null)}})]})}var B=s(4193),K=s(4966),V=s(3622),X=s(7291),Z=s(1123);function q(e){let{open:l,relic:s,effects:a,categories:t,onSave:r,onClose:h}=e,[o,x]=(0,n.useState)("赤"),[v,g]=(0,n.useState)(""),[p,S]=(0,n.useState)(""),[C,b]=(0,n.useState)(""),[y,w]=(0,n.useState)(""),[E,I]=(0,n.useState)(""),[G,k]=(0,n.useState)("");(0,n.useEffect)(()=>{if(s){x(s.color),g(s.effects[0]),S(s.effects[1]),b(s.effects[2]);let e=a.find(e=>e.id===s.effects[0]),l=a.find(e=>e.id===s.effects[1]),i=a.find(e=>e.id===s.effects[2]);w((null==e?void 0:e.categoryId)||""),I((null==l?void 0:l.categoryId)||""),k((null==i?void 0:i.categoryId)||"")}else x("赤"),g(""),S(""),b(""),w(""),I(""),k("")},[s,a]);let R=(0,n.useMemo)(()=>y?a.filter(e=>e.categoryId===y):[],[a,y]),W=(0,n.useMemo)(()=>E?a.filter(e=>e.categoryId===E):[],[a,E]),N=(0,n.useMemo)(()=>G?a.filter(e=>e.categoryId===G):[],[a,G]),U=v&&p&&C;return(0,i.jsxs)(D.A,{open:l,onClose:h,maxWidth:"md",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"遺物を編集":"遺物を登録"}),(0,i.jsx)(L.A,{children:(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,i.jsxs)(A.A,{component:"fieldset",children:[(0,i.jsx)(K.A,{component:"legend",children:"色"}),(0,i.jsxs)(V.A,{row:!0,value:o,onChange:e=>x(e.target.value),children:[(0,i.jsx)(X.A,{value:"赤",control:(0,i.jsx)(Z.A,{}),label:"赤"}),(0,i.jsx)(X.A,{value:"青",control:(0,i.jsx)(Z.A,{}),label:"青"}),(0,i.jsx)(X.A,{value:"黄",control:(0,i.jsx)(Z.A,{}),label:"黄"}),(0,i.jsx)(X.A,{value:"緑",control:(0,i.jsx)(Z.A,{}),label:"緑"})]})]}),(0,i.jsx)(d.A,{variant:"subtitle2",sx:{mt:1},children:"効果1"}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{width:"20%"},children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:y,label:"カテゴリ",onChange:e=>{w(e.target.value),g("")},children:t.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{sx:{width:"80%"},disabled:!y,children:[(0,i.jsx)(j.A,{children:"効果"}),(0,i.jsx)(u.A,{value:v,label:"効果",onChange:e=>g(e.target.value),children:R.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.description},e.id))})]})]}),(0,i.jsx)(d.A,{variant:"subtitle2",sx:{mt:1},children:"効果2"}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{width:"20%"},children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:E,label:"カテゴリ",onChange:e=>{I(e.target.value),S("")},children:t.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{sx:{width:"80%"},disabled:!E,children:[(0,i.jsx)(j.A,{children:"効果"}),(0,i.jsx)(u.A,{value:p,label:"効果",onChange:e=>S(e.target.value),children:W.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.description},e.id))})]})]}),(0,i.jsx)(d.A,{variant:"subtitle2",sx:{mt:1},children:"効果3"}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{width:"20%"},children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:G,label:"カテゴリ",onChange:e=>{k(e.target.value),b("")},children:t.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{sx:{width:"80%"},disabled:!G,children:[(0,i.jsx)(j.A,{children:"効果"}),(0,i.jsx)(u.A,{value:C,label:"効果",onChange:e=>b(e.target.value),children:N.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.description},e.id))})]})]})]})}),(0,i.jsxs)(O.A,{children:[(0,i.jsx)(m.A,{onClick:h,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{r({id:(null==s?void 0:s.id)||crypto.randomUUID(),color:o,effects:[v,p,C]}),x("赤"),g(""),S(""),b(""),w(""),I(""),k("")},variant:"contained",disabled:!U,children:"保存"})]})]})}function Q(){let[e,l]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[t,d]=(0,n.useState)([]),[r,h]=(0,n.useState)(""),[o,G]=(0,n.useState)(""),[k,R]=(0,n.useState)(""),[W,N]=(0,n.useState)(null),[U,H]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let[e,s,i]=await Promise.all([T.getAll(),F.getAll(),z.getAll()]);l(e),a(s),d(i)})()},[]);let P=async s=>{let i;l(i=W?e.map(e=>e.id===s.id?s:e):[...e,s]),await T.save(i),H(!1),N(null)},D=async s=>{let i=e.filter(e=>e.id!==s);l(i),await T.save(i)},J=e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.description)||"不明な効果"},L=e.filter(e=>{let l=!o||e.color===o,i=!r||e.effects.some(e=>J(e).includes(r)),n=!k||e.effects.some(e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.categoryId)===k});return l&&i&&n});return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(c.A,{sx:{mb:2,display:"flex",gap:2},children:[(0,i.jsx)(x.A,{label:"効果で検索",value:r,onChange:e=>h(e.target.value),fullWidth:!0}),(0,i.jsxs)(A.A,{sx:{minWidth:150},children:[(0,i.jsx)(j.A,{children:"カテゴリで絞込"}),(0,i.jsxs)(u.A,{value:k,label:"カテゴリで絞込",onChange:e=>R(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),t.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)(A.A,{sx:{minWidth:150},children:[(0,i.jsx)(j.A,{children:"色で絞込"}),(0,i.jsxs)(u.A,{value:o,label:"色で絞込",onChange:e=>G(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),(0,i.jsx)(f.A,{value:"赤",children:"赤"}),(0,i.jsx)(f.A,{value:"青",children:"青"}),(0,i.jsx)(f.A,{value:"黄",children:"黄"}),(0,i.jsx)(f.A,{value:"緑",children:"緑"})]})]}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{N(null),H(!0)},children:"新規登録"})]}),(0,i.jsx)(v.A,{component:g.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{width:80,children:"色"}),(0,i.jsx)(b.A,{children:"効果1"}),(0,i.jsx)(b.A,{children:"効果2"}),(0,i.jsx)(b.A,{children:"効果3"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:L.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.color,color:{赤:"error",青:"primary",黄:"warning",緑:"success"}[e.color]})}),(0,i.jsx)(b.A,{children:J(e.effects[0])}),(0,i.jsx)(b.A,{children:J(e.effects[1])}),(0,i.jsx)(b.A,{children:J(e.effects[2])}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{N(e),H(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>D(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(q,{open:U,relic:W,effects:s,categories:t,onSave:P,onClose:()=>{H(!1),N(null)}})]})}function Y(e){let{open:l,category:s,onSave:a,onClose:t}=e,[d,r]=(0,n.useState)("");return(0,n.useEffect)(()=>{s?r(s.name):r("")},[s]),(0,i.jsxs)(D.A,{open:l,onClose:t,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"カテゴリを編集":"カテゴリを登録"}),(0,i.jsx)(L.A,{children:(0,i.jsx)(x.A,{autoFocus:!0,margin:"dense",label:"カテゴリ名",fullWidth:!0,value:d,onChange:e=>r(e.target.value)})}),(0,i.jsxs)(O.A,{children:[(0,i.jsx)(m.A,{onClick:t,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{a({id:(null==s?void 0:s.id)||crypto.randomUUID(),name:d}),r("")},variant:"contained",disabled:!d,children:"保存"})]})]})}function $(){let[e,l]=(0,n.useState)([]),[s,a]=(0,n.useState)(null),[t,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{l(await z.getAll())})()},[]);let r=async i=>{let n;l(n=s?e.map(e=>e.id===i.id?i:e):[...e,i]),await z.save(n),d(!1),a(null)},h=async s=>{if(s===N)return void alert("「その他」カテゴリは削除できません。");let i=e.filter(e=>e.id!==s);l(i),await z.save(i)};return(0,i.jsxs)(c.A,{children:[(0,i.jsx)(c.A,{sx:{mb:2,display:"flex",gap:2,justifyContent:"flex-end"},children:(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{a(null),d(!0)},children:"新規登録"})}),(0,i.jsx)(v.A,{component:g.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"カテゴリ名"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:e.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:e.name}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{a(e),d(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>h(e.id),size:"small",disabled:e.id===N,children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(Y,{open:t,category:s,onSave:r,onClose:()=>{d(!1),a(null)}})]})}function ee(e){let{open:l,nightRunner:s,onSave:a,onClose:t}=e,[d,r]=(0,n.useState)("");return(0,n.useEffect)(()=>{s?r(s.name):r("")},[s]),(0,i.jsxs)(D.A,{open:l,onClose:t,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"夜渡りを編集":"夜渡りを登録"}),(0,i.jsx)(L.A,{children:(0,i.jsx)(x.A,{autoFocus:!0,margin:"dense",label:"名前",fullWidth:!0,value:d,onChange:e=>r(e.target.value)})}),(0,i.jsxs)(O.A,{children:[(0,i.jsx)(m.A,{onClick:t,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{a({id:(null==s?void 0:s.id)||crypto.randomUUID(),name:d}),r("")},variant:"contained",disabled:!d,children:"保存"})]})]})}function el(){let[e,l]=(0,n.useState)([]),[s,a]=(0,n.useState)(null),[t,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{l(await H.getAll())})()},[]);let r=async i=>{let n;l(n=s?e.map(e=>e.id===i.id?i:e):[...e,i]),await H.save(n),d(!1),a(null)},h=async s=>{let i=e.filter(e=>e.id!==s);l(i),await H.save(i)};return(0,i.jsxs)(c.A,{children:[(0,i.jsx)(c.A,{sx:{mb:2,display:"flex",gap:2,justifyContent:"flex-end"},children:(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{a(null),d(!0)},children:"新規登録"})}),(0,i.jsx)(v.A,{component:g.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"名前"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:e.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:e.name}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{a(e),d(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>h(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(ee,{open:t,nightRunner:s,onSave:r,onClose:()=>{d(!1),a(null)}})]})}let es=["赤","青","黄","緑","無色"];function ei(e){let{open:l,grail:s,nightRunners:a,onSave:t,onClose:d}=e,[r,h]=(0,n.useState)(""),[o,x]=(0,n.useState)("赤"),[v,g]=(0,n.useState)("青"),[p,S]=(0,n.useState)("黄");return(0,n.useEffect)(()=>{s?(h(s.nightRunnerId),x(s.colors[0]),g(s.colors[1]),S(s.colors[2])):(h(""),x("赤"),g("青"),S("黄"))},[s]),(0,i.jsxs)(D.A,{open:l,onClose:d,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"盃を編集":"盃を登録"}),(0,i.jsx)(L.A,{children:(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"夜渡り"}),(0,i.jsx)(u.A,{value:r,label:"夜渡り",onChange:e=>h(e.target.value),children:a.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"色1"}),(0,i.jsx)(u.A,{value:o,label:"色1",onChange:e=>x(e.target.value),children:es.map(e=>(0,i.jsx)(f.A,{value:e,children:e},e))})]}),(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"色2"}),(0,i.jsx)(u.A,{value:v,label:"色2",onChange:e=>g(e.target.value),children:es.map(e=>(0,i.jsx)(f.A,{value:e,children:e},e))})]}),(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"色3"}),(0,i.jsx)(u.A,{value:p,label:"色3",onChange:e=>S(e.target.value),children:es.map(e=>(0,i.jsx)(f.A,{value:e,children:e},e))})]})]})}),(0,i.jsxs)(O.A,{children:[(0,i.jsx)(m.A,{onClick:d,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{t({id:(null==s?void 0:s.id)||crypto.randomUUID(),nightRunnerId:r,colors:[o,v,p]}),h(""),x("赤"),g("青"),S("黄")},variant:"contained",disabled:!r,children:"保存"})]})]})}function en(){let[e,l]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[t,d]=(0,n.useState)(""),[r,h]=(0,n.useState)(null),[o,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let[e,s]=await Promise.all([P.getAll(),H.getAll()]);l(e),a(s)})()},[]);let G=async s=>{let i;l(i=r?e.map(e=>e.id===s.id?s:e):[...e,s]),await P.save(i),x(!1),h(null)},k=async s=>{let i=e.filter(e=>e.id!==s);l(i),await P.save(i)},R=e.filter(e=>!t||e.nightRunnerId===t),W=e=>({赤:"error",青:"primary",黄:"warning",緑:"success",無色:"default"})[e];return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(c.A,{sx:{mb:2,display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{minWidth:200},children:[(0,i.jsx)(j.A,{children:"夜渡りで絞込"}),(0,i.jsxs)(u.A,{value:t,label:"夜渡りで絞込",onChange:e=>d(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),s.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))]})]}),(0,i.jsx)(c.A,{sx:{flex:1}}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{h(null),x(!0)},children:"新規登録"})]}),(0,i.jsx)(v.A,{component:g.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"夜渡り"}),(0,i.jsx)(b.A,{width:100,children:"色1"}),(0,i.jsx)(b.A,{width:100,children:"色2"}),(0,i.jsx)(b.A,{width:100,children:"色3"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:R.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.name)||"不明"})(e.nightRunnerId)}),(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.colors[0],color:W(e.colors[0])})}),(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.colors[1],color:W(e.colors[1])})}),(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.colors[2],color:W(e.colors[2])})}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{h(e),x(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>k(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(ei,{open:o,grail:r,nightRunners:s,onSave:G,onClose:()=>{x(!1),h(null)}})]})}var ea=s(9630),et=s(3664),ed=s(9131);function er(){let[e,l]=(0,n.useState)([]),[s,a]=(0,n.useState)([]),[t,r]=(0,n.useState)([]),[h,o]=(0,n.useState)([]),[x,w]=(0,n.useState)(""),[E,I]=(0,n.useState)([]),[G,k]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{let[e,s,i,n]=await Promise.all([H.getAll(),P.getAll(),T.getAll(),F.getAll()]);l(e),a(s),r(i),o(n)})()},[]);let R=e=>{let l=h.find(l=>l.id===e);return(null==l?void 0:l.description)||"不明"};return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(g.A,{sx:{p:3,mb:3},children:[(0,i.jsx)(d.A,{variant:"h6",sx:{mb:2},children:"複合検索"}),(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"夜渡り"}),(0,i.jsx)(u.A,{value:x,label:"夜渡り",onChange:e=>w(e.target.value),children:e.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"効果（複数選択可）"}),(0,i.jsx)(u.A,{multiple:!0,value:E,onChange:e=>I("string"==typeof e.target.value?[e.target.value]:e.target.value),input:(0,i.jsx)(ea.A,{label:"効果（複数選択可）"}),renderValue:e=>"".concat(e.length,"個選択中"),children:h.map(e=>(0,i.jsxs)(f.A,{value:e.id,children:[(0,i.jsx)(et.A,{checked:E.indexOf(e.id)>-1}),(0,i.jsx)(ed.A,{primary:e.description})]},e.id))})]}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{if(!x||0===E.length)return void k([]);let l=s.filter(l=>{let s=e.find(e=>e.id===l.nightRunnerId);return l.nightRunnerId===x||(null==s?void 0:s.name)==="全員"}),i=[];for(let e of l){let l=[],s=new Set;for(let i of e.colors){let e=t.filter(e=>{if(s.has(e.id)||"無色"!==i&&e.color!==i)return!1;let n=e.effects;return E.some(e=>!l.some(l=>l.effects.includes(e))&&n.includes(e))}),n=null,a=0;for(let s of e){let e=new Set;l.forEach(l=>l.effects.forEach(l=>e.add(l)));let i=E.filter(l=>s.effects.includes(l)&&!e.has(l)).length;i>a&&(a=i,n=s)}n&&(l.push(n),s.add(n.id))}let n=new Set;l.forEach(e=>{e.effects.forEach(e=>{E.includes(e)&&n.add(e)})}),n.size===E.length&&i.push({grail:e,relics:l})}k(i)},disabled:!x||0===E.length,children:"検索"})]})]}),G.length>0&&(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(d.A,{variant:"h6",sx:{mb:2},children:["検索結果: ",G.length,"件"]}),G.map((l,s)=>(0,i.jsxs)(g.A,{sx:{p:2,mb:2},children:[(0,i.jsxs)(d.A,{variant:"subtitle1",sx:{mb:1},children:["盃: ",(l=>{let s=e.find(e=>e.id===l);return(null==s?void 0:s.name)||"不明"})(l.grail.nightRunnerId)," - ",l.grail.colors.map(e=>e).join("・")]}),(0,i.jsx)(v.A,{children:(0,i.jsxs)(p.A,{size:"small",children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"色"}),(0,i.jsx)(b.A,{children:"効果1"}),(0,i.jsx)(b.A,{children:"効果2"}),(0,i.jsx)(b.A,{children:"効果3"})]})}),(0,i.jsx)(y.A,{children:l.relics.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.color,color:{赤:"error",青:"primary",黄:"warning",緑:"success",無色:"default"}[e.color],size:"small"})}),(0,i.jsx)(b.A,{children:R(e.effects[0])}),(0,i.jsx)(b.A,{children:R(e.effects[1])}),(0,i.jsx)(b.A,{children:R(e.effects[2])})]},e.id))})]})})]},s))]}),0===G.length&&x&&E.length>0&&(0,i.jsx)(g.A,{sx:{p:3},children:(0,i.jsx)(d.A,{color:"text.secondary",children:"条件に一致する組み合わせが見つかりませんでした。"})})]})}function ec(){let[e,l]=(0,n.useState)(0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.A,{position:"static",children:(0,i.jsx)(t.A,{children:(0,i.jsx)(d.A,{variant:"h6",component:"div",children:"遺物管理システム"})})}),(0,i.jsxs)(r.A,{maxWidth:"lg",sx:{mt:4},children:[(0,i.jsx)(c.A,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,i.jsxs)(h.A,{value:e,onChange:(e,s)=>l(s),children:[(0,i.jsx)(o.A,{label:"複合検索"}),(0,i.jsx)(o.A,{label:"遺物"}),(0,i.jsx)(o.A,{label:"効果"}),(0,i.jsx)(o.A,{label:"カテゴリ"}),(0,i.jsx)(o.A,{label:"夜渡り"}),(0,i.jsx)(o.A,{label:"盃"})]})}),0===e&&(0,i.jsx)(er,{}),1===e&&(0,i.jsx)(Q,{}),2===e&&(0,i.jsx)(M,{}),3===e&&(0,i.jsx)($,{}),4===e&&(0,i.jsx)(el,{}),5===e&&(0,i.jsx)(en,{})]})]})}},4135:(e,l,s)=>{Promise.resolve().then(s.bind(s,2887))}},e=>{e.O(0,[135,865,685,441,255,358],()=>e(e.s=4135)),_N_E=e.O()}]);