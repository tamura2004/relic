(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2887:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>ej});var i=s(5155),n=s(2115),t=s(8492),a=s(2531),d=s(317),r=s(6245),c=s(357),h=s(9300),x=s(5416),o=s(670),A=s(2995),j=s(4177),u=s(2111),f=s(8963),m=s(7855),g=s(8447),v=s(5970),p=s(6120),S=s(223),C=s(4463),b=s(1512),y=s(6388),w=s(4288),E=s(1665),I=s(6170),k=s(2078),G=s(9708);let R=(0,k.Wp)({apiKey:"AIzaSyAffBMfX9NHVgSg_w4a8ZKa55vmp0eHb2w",authDomain:"dd5tools.firebaseapp.com",databaseURL:"https://dd5tools.firebaseio.com",projectId:"dd5tools",storageBucket:"dd5tools.appspot.com",messagingSenderId:"1096592466642",appId:"1:1096592466642:web:f03ea81d304964f1f1030b"}),W=(0,G.aU)(R),N="default_other",U={CATEGORIES:"categories",EFFECTS:"effects",RELICS:"relics",NIGHTRUNNERS:"nightrunners",GRAILS:"grails"},z={getAll:async()=>{let e=(0,G.rJ)(W,U.CATEGORIES),l=(0,G.P)(e,(0,G.My)("name")),s=(await (0,G.GG)(l)).docs.map(e=>({...e.data(),id:e.id}));if(!s.find(e=>e.id===N)){let e={id:N,name:"その他"};await (0,G.BN)((0,G.H9)(W,U.CATEGORIES,N),{name:e.name}),s.unshift(e)}return s},save:async e=>{let l=(0,G.wP)(W);(await (0,G.GG)((0,G.rJ)(W,U.CATEGORIES))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,G.H9)(W,U.CATEGORIES,e.id);l.set(s,{name:e.name})}),await l.commit()}},F={getAll:async()=>{let e=(0,G.rJ)(W,U.EFFECTS),l=(await (0,G.GG)(e)).docs.map(e=>({...e.data(),id:e.id}));if(l.some(e=>!e.categoryId)){let e=(0,G.wP)(W);l.forEach(l=>{if(!l.categoryId){l.categoryId=N;let s=(0,G.H9)(W,U.EFFECTS,l.id);e.update(s,{categoryId:N})}}),await e.commit()}return l},save:async e=>{let l=(0,G.wP)(W);(await (0,G.GG)((0,G.rJ)(W,U.EFFECTS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,G.H9)(W,U.EFFECTS,e.id);l.set(s,{categoryId:e.categoryId,description:e.description})}),await l.commit()}},T={getAll:async()=>{let e=(0,G.rJ)(W,U.RELICS);return(await (0,G.GG)(e)).docs.map(e=>({...e.data(),id:e.id}))},save:async e=>{let l=(0,G.wP)(W);(await (0,G.GG)((0,G.rJ)(W,U.RELICS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,G.H9)(W,U.RELICS,e.id);l.set(s,{color:e.color,effects:e.effects})}),await l.commit()}},H={getAll:async()=>{let e=(0,G.rJ)(W,U.NIGHTRUNNERS);return(await (0,G.GG)(e)).docs.map(e=>({...e.data(),id:e.id}))},save:async e=>{let l=(0,G.wP)(W);(await (0,G.GG)((0,G.rJ)(W,U.NIGHTRUNNERS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,G.H9)(W,U.NIGHTRUNNERS,e.id);l.set(s,{name:e.name})}),await l.commit()}},P={getAll:async()=>{let e=(0,G.rJ)(W,U.GRAILS);return(await (0,G.GG)(e)).docs.map(e=>({...e.data(),id:e.id}))},save:async e=>{let l=(0,G.wP)(W);(await (0,G.GG)((0,G.rJ)(W,U.GRAILS))).docs.forEach(e=>{l.delete(e.ref)}),e.forEach(e=>{let s=(0,G.H9)(W,U.GRAILS,e.id);l.set(s,{nightRunnerId:e.nightRunnerId,colors:e.colors})}),await l.commit()}};var D=s(5265),J=s(2021),L=s(9496),_=s(6370);function O(e){let{open:l,effect:s,categories:t,onSave:a,onClose:d}=e,[r,h]=(0,n.useState)(""),[x,g]=(0,n.useState)(N);return(0,n.useEffect)(()=>{s?(h(s.description),g(s.categoryId||N)):(h(""),g(N))},[s]),(0,i.jsxs)(D.A,{open:l,onClose:d,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"効果を編集":"効果を登録"}),(0,i.jsx)(L.A,{children:(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:x,label:"カテゴリ",onChange:e=>g(e.target.value),children:t.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsx)(o.A,{autoFocus:!0,label:"効果",fullWidth:!0,value:r,onChange:e=>h(e.target.value)})]})}),(0,i.jsxs)(_.A,{children:[(0,i.jsx)(m.A,{onClick:d,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{a({id:(null==s?void 0:s.id)||crypto.randomUUID(),categoryId:x,description:r}),h(""),g(N)},variant:"contained",disabled:!r,children:"保存"})]})]})}function M(){let[e,l]=(0,n.useState)([]),[s,t]=(0,n.useState)([]),[a,d]=(0,n.useState)(""),[r,h]=(0,n.useState)(""),[x,k]=(0,n.useState)(null),[G,R]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let[e,s]=await Promise.all([F.getAll(),z.getAll()]);l(e),t(s)})()},[]);let W=async s=>{let i;l(i=x?e.map(e=>e.id===s.id?s:e):[...e,s]),await F.save(i),R(!1),k(null)},N=async s=>{let i=e.filter(e=>e.id!==s);l(i),await F.save(i)},U=e.filter(e=>{let l=e.description.includes(a),s=!r||e.categoryId===r;return l&&s});return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(c.A,{sx:{mb:2,display:"flex",gap:2},children:[(0,i.jsx)(o.A,{label:"効果で検索",value:a,onChange:e=>d(e.target.value),fullWidth:!0}),(0,i.jsxs)(A.A,{sx:{minWidth:200},children:[(0,i.jsx)(j.A,{children:"カテゴリで絞込"}),(0,i.jsxs)(u.A,{value:r,label:"カテゴリで絞込",onChange:e=>h(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),s.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))]})]}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{k(null),R(!0)},children:"新規登録"})]}),(0,i.jsx)(g.A,{component:v.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{width:150,children:"カテゴリ"}),(0,i.jsx)(b.A,{children:"効果"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:U.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.name)||"その他"})(e.categoryId)}),(0,i.jsx)(b.A,{children:e.description}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{k(e),R(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>N(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(O,{open:G,effect:x,categories:s,onSave:W,onClose:()=>{R(!1),k(null)}})]})}var B=s(4193),K=s(4966),V=s(3622),X=s(7291),Z=s(1123);function q(e){let{open:l,relic:s,effects:t,categories:a,onSave:r,onClose:h}=e,[x,o]=(0,n.useState)("赤"),[g,v]=(0,n.useState)(""),[p,S]=(0,n.useState)(""),[C,b]=(0,n.useState)(""),[y,w]=(0,n.useState)(""),[E,I]=(0,n.useState)(""),[k,G]=(0,n.useState)("");(0,n.useEffect)(()=>{if(s){o(s.color),v(s.effects[0]),S(s.effects[1]),b(s.effects[2]);let e=t.find(e=>e.id===s.effects[0]),l=t.find(e=>e.id===s.effects[1]),i=t.find(e=>e.id===s.effects[2]);w((null==e?void 0:e.categoryId)||""),I((null==l?void 0:l.categoryId)||""),G((null==i?void 0:i.categoryId)||"")}else o("赤"),v(""),S(""),b(""),w(""),I(""),G("")},[s,t]);let R=(0,n.useMemo)(()=>y?t.filter(e=>e.categoryId===y):[],[t,y]),W=(0,n.useMemo)(()=>E?t.filter(e=>e.categoryId===E):[],[t,E]),N=(0,n.useMemo)(()=>k?t.filter(e=>e.categoryId===k):[],[t,k]),U=g&&p&&C;return(0,i.jsxs)(D.A,{open:l,onClose:h,maxWidth:"md",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"遺物を編集":"遺物を登録"}),(0,i.jsx)(L.A,{children:(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,i.jsxs)(A.A,{component:"fieldset",children:[(0,i.jsx)(K.A,{component:"legend",children:"色"}),(0,i.jsxs)(V.A,{row:!0,value:x,onChange:e=>o(e.target.value),children:[(0,i.jsx)(X.A,{value:"赤",control:(0,i.jsx)(Z.A,{}),label:"赤"}),(0,i.jsx)(X.A,{value:"青",control:(0,i.jsx)(Z.A,{}),label:"青"}),(0,i.jsx)(X.A,{value:"黄",control:(0,i.jsx)(Z.A,{}),label:"黄"}),(0,i.jsx)(X.A,{value:"緑",control:(0,i.jsx)(Z.A,{}),label:"緑"})]})]}),(0,i.jsx)(d.A,{variant:"subtitle2",sx:{mt:1},children:"効果1"}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{width:"20%"},children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:y,label:"カテゴリ",onChange:e=>{w(e.target.value),v("")},children:a.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{sx:{width:"80%"},disabled:!y,children:[(0,i.jsx)(j.A,{children:"効果"}),(0,i.jsx)(u.A,{value:g,label:"効果",onChange:e=>v(e.target.value),children:R.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.description},e.id))})]})]}),(0,i.jsx)(d.A,{variant:"subtitle2",sx:{mt:1},children:"効果2"}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{width:"20%"},children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:E,label:"カテゴリ",onChange:e=>{I(e.target.value),S("")},children:a.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{sx:{width:"80%"},disabled:!E,children:[(0,i.jsx)(j.A,{children:"効果"}),(0,i.jsx)(u.A,{value:p,label:"効果",onChange:e=>S(e.target.value),children:W.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.description},e.id))})]})]}),(0,i.jsx)(d.A,{variant:"subtitle2",sx:{mt:1},children:"効果3"}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{width:"20%"},children:[(0,i.jsx)(j.A,{children:"カテゴリ"}),(0,i.jsx)(u.A,{value:k,label:"カテゴリ",onChange:e=>{G(e.target.value),b("")},children:a.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{sx:{width:"80%"},disabled:!k,children:[(0,i.jsx)(j.A,{children:"効果"}),(0,i.jsx)(u.A,{value:C,label:"効果",onChange:e=>b(e.target.value),children:N.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.description},e.id))})]})]})]})}),(0,i.jsxs)(_.A,{children:[(0,i.jsx)(m.A,{onClick:h,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{r({id:(null==s?void 0:s.id)||crypto.randomUUID(),color:x,effects:[g,p,C]}),o("赤"),v(""),S(""),b(""),w(""),I(""),G("")},variant:"contained",disabled:!U,children:"保存"})]})]})}function Q(){let[e,l]=(0,n.useState)([]),[s,t]=(0,n.useState)([]),[a,d]=(0,n.useState)([]),[r,h]=(0,n.useState)(""),[x,k]=(0,n.useState)(""),[G,R]=(0,n.useState)(""),[W,N]=(0,n.useState)(null),[U,H]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let[e,s,i]=await Promise.all([T.getAll(),F.getAll(),z.getAll()]);l(e),t(s),d(i)})()},[]);let P=async s=>{let i;l(i=W?e.map(e=>e.id===s.id?s:e):[...e,s]),await T.save(i),H(!1),N(null)},D=async s=>{let i=e.filter(e=>e.id!==s);l(i),await T.save(i)},J=e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.description)||"不明な効果"},L=e.filter(e=>{let l=!x||e.color===x,i=!r||e.effects.some(e=>J(e).includes(r)),n=!G||e.effects.some(e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.categoryId)===G});return l&&i&&n});return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(c.A,{sx:{mb:2,display:"flex",gap:2},children:[(0,i.jsx)(o.A,{label:"効果で検索",value:r,onChange:e=>h(e.target.value),fullWidth:!0}),(0,i.jsxs)(A.A,{sx:{minWidth:150},children:[(0,i.jsx)(j.A,{children:"カテゴリで絞込"}),(0,i.jsxs)(u.A,{value:G,label:"カテゴリで絞込",onChange:e=>R(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),a.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)(A.A,{sx:{minWidth:150},children:[(0,i.jsx)(j.A,{children:"色で絞込"}),(0,i.jsxs)(u.A,{value:x,label:"色で絞込",onChange:e=>k(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),(0,i.jsx)(f.A,{value:"赤",children:"赤"}),(0,i.jsx)(f.A,{value:"青",children:"青"}),(0,i.jsx)(f.A,{value:"黄",children:"黄"}),(0,i.jsx)(f.A,{value:"緑",children:"緑"})]})]}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{N(null),H(!0)},children:"新規登録"})]}),(0,i.jsx)(g.A,{component:v.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{width:80,children:"色"}),(0,i.jsx)(b.A,{children:"効果1"}),(0,i.jsx)(b.A,{children:"効果2"}),(0,i.jsx)(b.A,{children:"効果3"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:L.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.color,color:{赤:"error",青:"primary",黄:"warning",緑:"success"}[e.color]})}),(0,i.jsx)(b.A,{children:J(e.effects[0])}),(0,i.jsx)(b.A,{children:J(e.effects[1])}),(0,i.jsx)(b.A,{children:J(e.effects[2])}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{N(e),H(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>D(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(q,{open:U,relic:W,effects:s,categories:a,onSave:P,onClose:()=>{H(!1),N(null)}})]})}function Y(e){let{open:l,category:s,onSave:t,onClose:a}=e,[d,r]=(0,n.useState)("");return(0,n.useEffect)(()=>{s?r(s.name):r("")},[s]),(0,i.jsxs)(D.A,{open:l,onClose:a,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"カテゴリを編集":"カテゴリを登録"}),(0,i.jsx)(L.A,{children:(0,i.jsx)(o.A,{autoFocus:!0,margin:"dense",label:"カテゴリ名",fullWidth:!0,value:d,onChange:e=>r(e.target.value)})}),(0,i.jsxs)(_.A,{children:[(0,i.jsx)(m.A,{onClick:a,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{t({id:(null==s?void 0:s.id)||crypto.randomUUID(),name:d}),r("")},variant:"contained",disabled:!d,children:"保存"})]})]})}function $(){let[e,l]=(0,n.useState)([]),[s,t]=(0,n.useState)(null),[a,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{l(await z.getAll())})()},[]);let r=async i=>{let n;l(n=s?e.map(e=>e.id===i.id?i:e):[...e,i]),await z.save(n),d(!1),t(null)},h=async s=>{if(s===N)return void alert("「その他」カテゴリは削除できません。");let i=e.filter(e=>e.id!==s);l(i),await z.save(i)};return(0,i.jsxs)(c.A,{children:[(0,i.jsx)(c.A,{sx:{mb:2,display:"flex",gap:2,justifyContent:"flex-end"},children:(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{t(null),d(!0)},children:"新規登録"})}),(0,i.jsx)(g.A,{component:v.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"カテゴリ名"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:e.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:e.name}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{t(e),d(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>h(e.id),size:"small",disabled:e.id===N,children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(Y,{open:a,category:s,onSave:r,onClose:()=>{d(!1),t(null)}})]})}function ee(e){let{open:l,nightRunner:s,onSave:t,onClose:a}=e,[d,r]=(0,n.useState)("");return(0,n.useEffect)(()=>{s?r(s.name):r("")},[s]),(0,i.jsxs)(D.A,{open:l,onClose:a,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"夜渡りを編集":"夜渡りを登録"}),(0,i.jsx)(L.A,{children:(0,i.jsx)(o.A,{autoFocus:!0,margin:"dense",label:"名前",fullWidth:!0,value:d,onChange:e=>r(e.target.value)})}),(0,i.jsxs)(_.A,{children:[(0,i.jsx)(m.A,{onClick:a,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{t({id:(null==s?void 0:s.id)||crypto.randomUUID(),name:d}),r("")},variant:"contained",disabled:!d,children:"保存"})]})]})}function el(){let[e,l]=(0,n.useState)([]),[s,t]=(0,n.useState)(null),[a,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{l(await H.getAll())})()},[]);let r=async i=>{let n;l(n=s?e.map(e=>e.id===i.id?i:e):[...e,i]),await H.save(n),d(!1),t(null)},h=async s=>{let i=e.filter(e=>e.id!==s);l(i),await H.save(i)};return(0,i.jsxs)(c.A,{children:[(0,i.jsx)(c.A,{sx:{mb:2,display:"flex",gap:2,justifyContent:"flex-end"},children:(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{t(null),d(!0)},children:"新規登録"})}),(0,i.jsx)(g.A,{component:v.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"名前"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:e.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:e.name}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{t(e),d(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>h(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(ee,{open:a,nightRunner:s,onSave:r,onClose:()=>{d(!1),t(null)}})]})}let es=["赤","青","黄","緑","無色"];function ei(e){let{open:l,grail:s,nightRunners:t,onSave:a,onClose:d}=e,[r,h]=(0,n.useState)(""),[x,o]=(0,n.useState)("赤"),[g,v]=(0,n.useState)("青"),[p,S]=(0,n.useState)("黄");return(0,n.useEffect)(()=>{s?(h(s.nightRunnerId),o(s.colors[0]),v(s.colors[1]),S(s.colors[2])):(h(""),o("赤"),v("青"),S("黄"))},[s]),(0,i.jsxs)(D.A,{open:l,onClose:d,maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(J.A,{children:s?"盃を編集":"盃を登録"}),(0,i.jsx)(L.A,{children:(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"夜渡り"}),(0,i.jsx)(u.A,{value:r,label:"夜渡り",onChange:e=>h(e.target.value),children:t.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))})]}),(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"色1"}),(0,i.jsx)(u.A,{value:x,label:"色1",onChange:e=>o(e.target.value),children:es.map(e=>(0,i.jsx)(f.A,{value:e,children:e},e))})]}),(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"色2"}),(0,i.jsx)(u.A,{value:g,label:"色2",onChange:e=>v(e.target.value),children:es.map(e=>(0,i.jsx)(f.A,{value:e,children:e},e))})]}),(0,i.jsxs)(A.A,{fullWidth:!0,children:[(0,i.jsx)(j.A,{children:"色3"}),(0,i.jsx)(u.A,{value:p,label:"色3",onChange:e=>S(e.target.value),children:es.map(e=>(0,i.jsx)(f.A,{value:e,children:e},e))})]})]})}),(0,i.jsxs)(_.A,{children:[(0,i.jsx)(m.A,{onClick:d,children:"キャンセル"}),(0,i.jsx)(m.A,{onClick:()=>{a({id:(null==s?void 0:s.id)||crypto.randomUUID(),nightRunnerId:r,colors:[x,g,p]}),h(""),o("赤"),v("青"),S("黄")},variant:"contained",disabled:!r,children:"保存"})]})]})}function en(){let[e,l]=(0,n.useState)([]),[s,t]=(0,n.useState)([]),[a,d]=(0,n.useState)(""),[r,h]=(0,n.useState)(null),[x,o]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let[e,s]=await Promise.all([P.getAll(),H.getAll()]);l(e),t(s)})()},[]);let k=async s=>{let i;l(i=r?e.map(e=>e.id===s.id?s:e):[...e,s]),await P.save(i),o(!1),h(null)},G=async s=>{let i=e.filter(e=>e.id!==s);l(i),await P.save(i)},R=e.filter(e=>!a||e.nightRunnerId===a),W=e=>({赤:"error",青:"primary",黄:"warning",緑:"success",無色:"default"})[e];return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(c.A,{sx:{mb:2,display:"flex",gap:2},children:[(0,i.jsxs)(A.A,{sx:{minWidth:200},children:[(0,i.jsx)(j.A,{children:"夜渡りで絞込"}),(0,i.jsxs)(u.A,{value:a,label:"夜渡りで絞込",onChange:e=>d(e.target.value),children:[(0,i.jsx)(f.A,{value:"",children:"すべて"}),s.map(e=>(0,i.jsx)(f.A,{value:e.id,children:e.name},e.id))]})]}),(0,i.jsx)(c.A,{sx:{flex:1}}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{h(null),o(!0)},children:"新規登録"})]}),(0,i.jsx)(g.A,{component:v.A,children:(0,i.jsxs)(p.A,{children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"夜渡り"}),(0,i.jsx)(b.A,{width:100,children:"色1"}),(0,i.jsx)(b.A,{width:100,children:"色2"}),(0,i.jsx)(b.A,{width:100,children:"色3"}),(0,i.jsx)(b.A,{width:120,children:"操作"})]})}),(0,i.jsx)(y.A,{children:R.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(e=>{let l=s.find(l=>l.id===e);return(null==l?void 0:l.name)||"不明"})(e.nightRunnerId)}),(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.colors[0],color:W(e.colors[0])})}),(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.colors[1],color:W(e.colors[1])})}),(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.colors[2],color:W(e.colors[2])})}),(0,i.jsxs)(b.A,{children:[(0,i.jsx)(w.A,{onClick:()=>{h(e),o(!0)},size:"small",children:(0,i.jsx)(E.A,{})}),(0,i.jsx)(w.A,{onClick:()=>G(e.id),size:"small",children:(0,i.jsx)(I.A,{})})]})]},e.id))})]})}),(0,i.jsx)(ei,{open:x,grail:r,nightRunners:s,onSave:k,onClose:()=>{o(!1),h(null)}})]})}var et=s(4962),ea=s(7524),ed=s(4251),er=s(9518),ec=s(1008),eh=s(3664),ex=s(9131),eo=s(9620);function eA(){let[e,l]=(0,n.useState)([]),[s,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[h,x]=(0,n.useState)([]),[o,j]=(0,n.useState)([]),[u,f]=(0,n.useState)(""),[w,E]=(0,n.useState)([]),[I,k]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{let[e,s,i,n,a]=await Promise.all([H.getAll(),P.getAll(),T.getAll(),F.getAll(),z.getAll()]);l(e),t(s),r(i),x(n),j(a)})()},[]);let G=e=>{let l=h.find(l=>l.id===e);return(null==l?void 0:l.description)||"不明"};return(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(v.A,{sx:{p:3,mb:3},children:[(0,i.jsx)(d.A,{variant:"h6",sx:{mb:2},children:"複合検索"}),(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsxs)(A.A,{children:[(0,i.jsx)(K.A,{children:"夜渡り"}),(0,i.jsx)(V.A,{value:u,onChange:e=>f(e.target.value),children:e.map(e=>(0,i.jsx)(X.A,{value:e.id,control:(0,i.jsx)(Z.A,{}),label:e.name},e.id))})]}),(0,i.jsxs)(c.A,{sx:{width:"100%"},children:[(0,i.jsxs)(d.A,{variant:"body2",sx:{mb:1,color:"text.secondary"},children:["効果（複数選択可）: ",w.length,"個選択中"]}),o.map(e=>{let l=h.filter(l=>l.categoryId===e.id);return 0===l.length?null:(0,i.jsxs)(et.A,{children:[(0,i.jsx)(ea.A,{expandIcon:(0,i.jsx)(eo.A,{}),children:(0,i.jsxs)(d.A,{children:[e.name," (",l.filter(e=>w.includes(e.id)).length,"/",l.length,")"]})}),(0,i.jsx)(ed.A,{children:(0,i.jsx)(er.A,{sx:{width:"100%",p:0},children:l.map(e=>(0,i.jsxs)(ec.Ay,{sx:{px:0},onClick:()=>{E(w.includes(e.id)?w.filter(l=>l!==e.id):[...w,e.id])},children:[(0,i.jsx)(eh.A,{checked:w.includes(e.id)}),(0,i.jsx)(ex.A,{primary:e.description})]},e.id))})})]},e.id)})]}),(0,i.jsx)(m.A,{variant:"contained",onClick:()=>{if(!u||0===w.length)return void k([]);let l=s.filter(l=>{let s=e.find(e=>e.id===l.nightRunnerId);return l.nightRunnerId===u||(null==s?void 0:s.name)==="全員"}),i=[];for(let e of l){let l=[],s=new Set;for(let i of e.colors){let e=a.filter(e=>{if(s.has(e.id)||"無色"!==i&&e.color!==i)return!1;let n=e.effects;return w.some(e=>!l.some(l=>l.effects.includes(e))&&n.includes(e))}),n=null,t=0;for(let s of e){let e=new Set;l.forEach(l=>l.effects.forEach(l=>e.add(l)));let i=w.filter(l=>s.effects.includes(l)&&!e.has(l)).length;i>t&&(t=i,n=s)}n&&(l.push(n),s.add(n.id))}let n=new Set;l.forEach(e=>{e.effects.forEach(e=>{w.includes(e)&&n.add(e)})}),n.size===w.length&&i.push({grail:e,relics:l})}k(i)},disabled:!u||0===w.length,children:"検索"})]})]}),I.length>0&&(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(d.A,{variant:"h6",sx:{mb:2},children:["検索結果: ",I.length,"件"]}),I.map((l,s)=>(0,i.jsxs)(v.A,{sx:{p:2,mb:2},children:[(0,i.jsxs)(d.A,{variant:"subtitle1",sx:{mb:1},children:["盃: ",(l=>{let s=e.find(e=>e.id===l);return(null==s?void 0:s.name)||"不明"})(l.grail.nightRunnerId)," - ",l.grail.colors.map(e=>e).join("・")]}),(0,i.jsx)(g.A,{children:(0,i.jsxs)(p.A,{size:"small",children:[(0,i.jsx)(S.A,{children:(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:"色"}),(0,i.jsx)(b.A,{children:"効果1"}),(0,i.jsx)(b.A,{children:"効果2"}),(0,i.jsx)(b.A,{children:"効果3"})]})}),(0,i.jsx)(y.A,{children:l.relics.map(e=>(0,i.jsxs)(C.A,{children:[(0,i.jsx)(b.A,{children:(0,i.jsx)(B.A,{label:e.color,color:{赤:"error",青:"primary",黄:"warning",緑:"success",無色:"default"}[e.color],size:"small"})}),(0,i.jsx)(b.A,{children:G(e.effects[0])}),(0,i.jsx)(b.A,{children:G(e.effects[1])}),(0,i.jsx)(b.A,{children:G(e.effects[2])})]},e.id))})]})})]},s))]}),0===I.length&&u&&w.length>0&&(0,i.jsx)(v.A,{sx:{p:3},children:(0,i.jsx)(d.A,{color:"text.secondary",children:"条件に一致する組み合わせが見つかりませんでした。"})})]})}function ej(){let[e,l]=(0,n.useState)(0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.A,{position:"static",children:(0,i.jsx)(a.A,{children:(0,i.jsx)(d.A,{variant:"h6",component:"div",children:"遺物管理システム"})})}),(0,i.jsxs)(r.A,{maxWidth:"lg",sx:{mt:4},children:[(0,i.jsx)(c.A,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,i.jsxs)(h.A,{value:e,onChange:(e,s)=>l(s),children:[(0,i.jsx)(x.A,{label:"複合検索"}),(0,i.jsx)(x.A,{label:"遺物"}),(0,i.jsx)(x.A,{label:"効果"}),(0,i.jsx)(x.A,{label:"カテゴリ"}),(0,i.jsx)(x.A,{label:"夜渡り"}),(0,i.jsx)(x.A,{label:"盃"})]})}),0===e&&(0,i.jsx)(eA,{}),1===e&&(0,i.jsx)(Q,{}),2===e&&(0,i.jsx)(M,{}),3===e&&(0,i.jsx)($,{}),4===e&&(0,i.jsx)(el,{}),5===e&&(0,i.jsx)(en,{})]})]})}},4135:(e,l,s)=>{Promise.resolve().then(s.bind(s,2887))}},e=>{e.O(0,[135,865,799,441,255,358],()=>e(e.s=4135)),_N_E=e.O()}]);